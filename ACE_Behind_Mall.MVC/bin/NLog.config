<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true">
  <!-- 日志级别
      logger.Trace（“跟踪消息”）;
      logger.Debug（“调试消息”）;
      logger.Info（“信息性消息”）;
      logger.Warn（“警告消息”）;
      logger.Error（“错误消息”）;
      logger.Fatal（“致命错误消息“）
      -->
  <targets>
    <target name="console" xsi:type ="Console" />

    <target name="debugger" xsi:type="Debugger" layout="NLog: ${date:format=HH\:mm\:ss} | ${level:uppercase=true:padding=-5} | ${message}" />

    <target name="error_file" xsi:type="File"
                    fileName="${basedir}/Logs/Error/${shortdate}/error.txt" maxArchiveFiles="30"
                    layout="${longdate} | ${level:uppercase=false} | ${message} ${onexception}:${exception:format=tostring} ${newline} ${stacktrace} ${newline} " />

    <target name="trace_file" xsi:type="File"
                fileName="${basedir}/Logs/Trace/${shortdate}/Trace.txt" maxArchiveFiles="30"
                layout="${longdate} | ${level:uppercase=false} | ${message} ${onexception}:${exception:format=tostring} ${newline} ${stacktrace} ${newline} " />

    <target xsi:type="Database" name="database" connectionString="
				Data Source=.;Initial Catalog=ACE_Mall;Persist Security Info=True;
        User ID=sa;Password=123456"  commandText=" INSERT INTO Adm_Log(UserID,UserName,Account,OpType,OpContent,CreateTime) VALUES(@UserID, @UserName, @Account, @OpType, @OpContent, @CreateTime)">
      <parameter name = "@UserID" layout = "${event-context:item=UserID}"/>
      <parameter name = "@UserName" layout = "${event-context:item=UserName}" />
      <parameter name = "@Account" layout = "${event-context:item=Account}"/>
      <parameter name = "@OpType" layout = "${event-context:item=OpType}" />
      <parameter name = "@OpContent" layout = "${event-context:item=OpContent}" />
      <parameter name="@CreateTime" layout="${date}" />
    </target>
    <!--
    Write events to a file with the date in the filename.
    <target xsi:type="File" name="f" fileName="${basedir}/logs/${shortdate}.log"
            layout="${longdate} ${uppercase:${level}} ${message}" />
    -->
  </targets>

  <rules>
    <!-- add your logging rules here -->
    <logger name="*" writeTo="Console" />
    <logger name="*" minlevel="Debug" writeTo="debugger" />
    <logger name="*" minlevel="Error" writeTo="error_file" />
    <logger name="*" level="Trace" writeTo="trace_file" />
    <logger name="*" level="Info"  writeTo="database" />
    <!--
    Write all events with minimal level of Debug (So Debug, Info, Warn, Error and Fatal, but not Trace)  to "f"
    <logger name="*" minlevel="Debug" writeTo="f" />
    -->
  </rules>
</nlog>
